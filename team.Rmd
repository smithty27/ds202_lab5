---
title: "Lab 5"
author: "Tyler Smith & Ritika Agrawal"
date: "April 8, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=F}
acc <- read.csv("accident.csv")
per <- read.csv("person.csv")
library(tidyverse)
library(dplyr)
library(ggplot2)
```

# Part 1: Accident Data
### Problem 1.1
```{r}
#1.1 are there some days of the week where more accidents happen than on others (use variable DAY_WEEK)?

d_count <- count(acc,DAY_WEEK)
d_count
d <- max(d_count)
d
```
  
Response: Yes. As can be seen from the output, the number of accidents each day varies. The max accidents happen on Day 7 of the week.  
  
### Problem 1.2
```{r}
#1.2 what time of the day do accidents happen (use variable HOUR)?
h_count <- count(acc,HOUR) 
h_count
h <- max(h_count)
h

```
  
Response: Accidents happen through the day as can be seen in the output of h_count. The max accidents happen at the 18th hour.  
  
### Problem 1.3  
```{r}

#1.3 what is the number of accidents with at least one drunk driver (use variable DRUNK_DR)?

drunk=subset(acc, acc$DRUNK_DR > 0 )
nrow(drunk)

```
  
Response: Number of accidents with at least one drunk driver are 8769.

  

# Part 2: connecting Data 
```{r}
#Filter by Person 1 and join with accident data
part2 <- per %>%
  filter(PER_TYP==1) %>%
  right_join(acc)

#Tally of day_week, hour and sex
day <- part2 %>%
  group_by(DAY_WEEK) %>%
  summarize(cOUNT = n())
day$DAY_WEEK <- as.factor(day$DAY_WEEK)
levels(day$DAY_WEEK) <-   c("Su","M","T","W","Th","F","Sa")

hour <- part2 %>%
  group_by(HOUR) %>%
  summarize(hour = n())

part2$SEX <- as.factor(part2$SEX)
levels(part2$SEX) <- c("M","F","U","U")
part2$SEX[is.na(part2$SEX)] <- "U"



sex <- part2 %>%
  group_by(SEX) %>%
  summarize(gender = n())
```
  
### Part 2 Visualizations
```{r}
day %>%
  ggplot(aes(x=DAY_WEEK,y=Day))+ geom_col() + labs(x="Day of the Week",y="Count of Accidents",title="Bar Plot of Accidents on Each Day of the Week")
```
  
In the plot above, we see that the weekend dates, Friday and Saturday, both have the most accidents. This is most likely due to most people being off and traveling more on the weekends, plus a likely abundance of drunk driving. There is also a distance third-place with Sunday, also a travel day, but it likely has fewer cases of drunk driving, or perhaps some early in the morning (i.e if someone was up late on Saturday night/Sunday morning).  
  
```{r}
hour %>%
  filter(HOUR<90) %>%
  ggplot(aes(x=HOUR,y=hour))+ geom_line() + geom_point() + labs(x="Time",y="Count of Accidents",title="Plot of Accidents during Each Hour")
```
  
In the bar plot above, we see that from midnight to 11 am, there are not many accidents. After 11 am, there are more accidnets occurring, and that continues to rise until 5 pm, when there becomes fewer accidents, with a sharp decrease after 7 pm. The number continues to drop until returning to numbers similar to the early morning at the 11 pm to midnight timeframe.  
  
```{r}
sex %>%
  filter(SEX %in% c("M","F")) %>%
  ggplot(aes(x=SEX,y=gender))+ geom_col() + labs(x="Sex",y="Count of Accidents",title="Bar Plot of Accidents by Sex")
```
  
The barplot above shows that males appear to have significantly more accidents than females.
  
    
# Part 3  
